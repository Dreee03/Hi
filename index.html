<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Love‚ù§Ô∏è</title>

<style>
/* ===== Soft Romantic Red Background (default) ===== */
body{
  margin:0;
  height:100vh;
  overflow:hidden;
  font-family: Arial, sans-serif;
  display:flex;
  justify-content:center;
  align-items:center;
  position:relative;

  background:
    radial-gradient(circle at 20% 15%, rgba(255,255,255,0.35), transparent 45%),
    radial-gradient(circle at 80% 10%, rgba(255,255,255,0.22), transparent 42%),
    radial-gradient(circle at 70% 85%, rgba(255,255,255,0.18), transparent 45%),
    linear-gradient(135deg, #ff6b81, #ff8fa3, #ffb3c1, #ff758f);
  background-size: 200% 200%;
  animation: bgMove 14s ease infinite;
}

@keyframes bgMove{
  0%{background-position:0% 50%}
  50%{background-position:100% 50%}
  100%{background-position:0% 50%}
}

body::before, body::after{
  content:"";
  position:fixed;
  width:520px; height:520px;
  border-radius:50%;
  filter: blur(70px);
  opacity:.26;
  z-index:0;
  pointer-events:none;
}
body::before{ background:#ff3b67; top:-160px; left:-180px; }
body::after { background:#ffd1dc; bottom:-220px; right:-180px; }

/* ===== Transparent background mode (on fail) ===== */
body.transparent-bg{
  background: transparent !important;
  animation: none !important;
}
body.transparent-bg::before,
body.transparent-bg::after{
  display:none !important;
}

/* ===== Floating hearts background ===== */
.heart-background{
  position:fixed;
  inset:0;
  overflow:hidden;
  z-index:0;
  pointer-events:none;
}

body.transparent-bg .heart-background{
  display:none !important;
}

.floating-heart{
  position:absolute;
  bottom:-60px;
  font-size:34px;
  animation: floatUp linear forwards;
  opacity:0;
  filter: drop-shadow(0 10px 18px rgba(255,0,80,0.25));
}

@keyframes floatUp{
  0%{ transform: translateY(0) scale(0.8) rotate(0deg); opacity:0; }
  12%{ opacity:0.95; }
  100%{ transform: translateY(-115vh) scale(1.55) rotate(360deg); opacity:0; }
}

/* ===== Main Container ===== */
.container{
  width:900px;
  height:540px;
  background: rgba(255,255,255,0.92);
  border-radius:26px;
  box-shadow:0 24px 70px rgba(0,0,0,0.25);
  position:relative;
  overflow:hidden;
  z-index:2;
}

h1{
  text-align:center;
  color:#ff124d;
  margin:16px 0 6px;
}

.subtitle{
  text-align:center;
  margin:0 0 10px;
  color:#444;
  font-size:14px;
}

.arena{
  position:relative;
  width:100%;
  height:440px;
  background: linear-gradient(180deg, #ffffff, #ffe3ea);
  border-top: 1px solid rgba(0,0,0,0.06);
}

/* HUD */
.stats{
  position:absolute;
  top:12px; left:18px;
  font-weight:bold;
  color:#2b2b2b;
  z-index:2;
}
.timer{
  position:absolute;
  top:12px; right:18px;
  font-weight:bold;
  color:#2b2b2b;
  z-index:2;
}

/* Player + hearts */
.player{
  position:absolute;
  font-size:42px;
  transform:translate(-50%,-50%);
  left:50%;
  top:70%;
  z-index:2;
}
.heart{
  position:absolute;
  font-size:30px;
  transform:translate(-50%,-50%);
  z-index:1;
}

/* Buttons */
button{
  padding:10px 18px;
  border:none;
  border-radius:12px;
  cursor:pointer;
  font-weight:bold;
}
#yesBtn{
  position:absolute;
  bottom:18px;
  left:35%;
  background:#ff124d;
  color:white;
  opacity:.55;
  cursor:not-allowed;
  z-index:2;
}
#yesBtn.unlocked{
  opacity:1;
  cursor:pointer;
}
#noBtn{
  position:absolute;
  bottom:18px;
  right:35%;
  background:#1b1b1b;
  color:white;
  z-index:2;
}

/* ===== Start Instructions Overlay ===== */
.start-overlay{
  position:absolute;
  inset:0;
  background: rgba(0,0,0,0.55);
  display:flex;
  justify-content:center;
  align-items:center;
  z-index:10;
  padding:18px;
}

.start-card{
  width:min(640px, 94vw);
  background:white;
  border-radius:22px;
  padding:22px 18px;
  text-align:center;
  box-shadow:0 22px 60px rgba(0,0,0,0.35);
}

.start-card h2{
  margin:0;
  color:#ff124d;
  font-size:26px;
}

.start-card p{
  margin:8px 0 0;
  color:#444;
  line-height:1.4;
}

.steps{
  text-align:left;
  margin:14px auto 0;
  background:#fff3f6;
  border:1px solid rgba(255,18,77,0.18);
  padding:14px 14px;
  border-radius:16px;
  max-width:540px;
  color:#333;
  line-height:1.55;
}
.steps b{ color:#ff124d; }

.start-btn{
  margin-top:14px;
  background:#ff124d;
  color:white;
  padding:12px 20px;
  border-radius:14px;
  font-size:15px;
}

.small-note{
  margin-top:10px;
  font-size:12px;
  color:#666;
}

/* ===== Letter modal ===== */
.modal{
  position:absolute;
  inset:0;
  background:rgba(0,0,0,0.62);
  display:none;
  justify-content:center;
  align-items:center;
  z-index:20;
  padding:18px;
}
.modal.show{ display:flex; }

.card{
  background:white;
  padding:26px;
  width:70%;
  max-height:80%;
  overflow:auto;
  border-radius:20px;
  text-align:left;
  white-space:pre-line;
  animation:fadeIn 0.9s ease;
}
@keyframes fadeIn{
  from{opacity:0; transform:scale(.86);}
  to{opacity:1; transform:scale(1);}
}

/* ===== Time-up Overlay (with Restart) ===== */
.timeout-overlay{
  position:absolute;
  inset:0;
  background: rgba(0,0,0,0.62);
  display:none;
  justify-content:center;
  align-items:center;
  z-index:30;
  padding:18px;
}
.timeout-overlay.show{ display:flex; }

.timeout-card{
  width:min(560px, 92vw);
  background:white;
  border-radius:22px;
  padding:22px 18px;
  text-align:center;
  box-shadow:0 22px 60px rgba(0,0,0,0.35);
}
.timeout-card h2{
  margin:0;
  color:#ff124d;
  font-size:24px;
}
.timeout-card p{
  margin:8px 0 0;
  color:#444;
}
.retry-btn{
  margin-top:14px;
  background:#ff124d;
  color:white;
  padding:12px 20px;
  border-radius:14px;
  font-size:15px;
}

/* ===== Fireworks particles (YES pressed) ===== */
.particle{
  position:fixed;
  left:0; top:0;
  transform: translate(-50%, -50%);
  will-change: transform, opacity;
  pointer-events:none;
  z-index:9999;
  filter: drop-shadow(0 10px 18px rgba(0,0,0,0.18));
  animation: burst var(--dur) ease-out forwards;
  opacity:1;
}

@keyframes burst{
  0%   { transform: translate(var(--x0), var(--y0)) scale(0.9); opacity:1; }
  70%  { opacity:1; }
  100% { transform: translate(var(--x1), var(--y1)) scale(1.25); opacity:0; }
}
</style>
</head>

<body>
<div class="heart-background"></div>

<div class="container">
  <h1>Catch 3 Heartsüíò</h1>
  <p class="subtitle">A tiny game for my favorite person ‚ù§Ô∏è</p>

  <div class="arena" id="arena">
    <div class="stats">Hearts: <span id="score">0</span>/3</div>
    <div class="timer">Time: <span id="time">20</span>s</div>

    <div class="player" id="player">üß∏</div>

    <button id="yesBtn">YES üíñ</button>
    <button id="noBtn">NO üíî</button>

    <!-- Start instructions overlay -->
    <div class="start-overlay" id="startOverlay">
      <div class="start-card">
        <h2>Hi my love üíû</h2>
        <p>I made this little game just for you‚Ä¶ because you‚Äôre my favorite person ü•∫</p>

        <div class="steps">
          <div><b>1.</b> Move the teddy üß∏ with your mouse (or finger).</div>
          <div><b>2.</b> Catch <b>3 hearts üíó</b> to continue.</div>
          <div><b>3.</b> The <b>NO</b> button is shy‚Ä¶üòè</div>
        </div>

        <button class="start-btn" id="startBtn">Start üíò</button>
        <div class="small-note">Good luck, baby. I‚Äôm cheering for you ‚ù§Ô∏è</div>
      </div>
    </div>

    <!-- Letter modal -->
    <div class="modal" id="modal">
      <div class="card" id="message"></div>
    </div>

    <!-- Time up overlay -->
    <div class="timeout-overlay" id="timeoutOverlay">
      <div class="timeout-card">
        <h2>Uh oh‚Ä¶ time is up üò≠</h2>
        <p>Try again, love? üíó</p>
        <button class="retry-btn" id="restartBtn">Restart üíò</button>
      </div>
    </div>
  </div>
</div>

<script>
/* ===== Your Letter (word for word) ===== */
const MESSAGE = `Hi my lovee!
it's been a long time since I've made you a letter, now here it is hehe. I just want to let you know that this past couple months has been happy and sad at the same time, happy is because you still keep on loving me, sad that I can not yet spoil you till you get sick of it heheheh. I know that we sometimes argue over little or big things and maybe most of it is because of me hehe, but underneath all that arguments, fights, and sadness that we felt, we still care deeply about each other and we would always find a way to fix it. I am grateful that I met and love the woman that you are inside and out. di na kayo nako taason hehe, Will you be my Valentines? (even if wala tay date nga garbo and igo rata magkita and bonding) hehe
- Dre`;

const TARGET = 3;
const START_TIME = 20;

const arena = document.getElementById("arena");
const player = document.getElementById("player");
const yesBtn = document.getElementById("yesBtn");
const noBtn = document.getElementById("noBtn");
const scoreEl = document.getElementById("score");
const timeEl = document.getElementById("time");
const modal = document.getElementById("modal");
const message = document.getElementById("message");
const heartBg = document.querySelector(".heart-background");

const startOverlay = document.getElementById("startOverlay");
const startBtn = document.getElementById("startBtn");

const timeoutOverlay = document.getElementById("timeoutOverlay");
const restartBtn = document.getElementById("restartBtn");

message.innerText = MESSAGE;

let score = 0;
let time = START_TIME;
let unlocked = false;
let gameStarted = false;
let noDodgeEnabled = true;

let spawnInterval = null;
let timerInterval = null;

/* ===== Move Player ===== */
function movePlayer(clientX, clientY){
  const rect = arena.getBoundingClientRect();
  const x = Math.max(18, Math.min(rect.width - 18, clientX - rect.left));
  const y = Math.max(70, Math.min(rect.height - 18, clientY - rect.top));
  player.style.left = x + "px";
  player.style.top = y + "px";
}

arena.addEventListener("mousemove", e=>{
  if(!gameStarted) return;
  movePlayer(e.clientX, e.clientY);
});

arena.addEventListener("touchstart", e=>{
  if(!gameStarted) return;
  const t = e.touches[0];
  movePlayer(t.clientX, t.clientY);
},{passive:true});

arena.addEventListener("touchmove", e=>{
  if(!gameStarted) return;
  const t = e.touches[0];
  movePlayer(t.clientX, t.clientY);
},{passive:true});

/* ===== Spawn Game Hearts ===== */
function spawnHeart(){
  if(!gameStarted) return;

  const heart = document.createElement("div");
  heart.className = "heart";
  heart.innerText = "üíó";

  const x = 30 + Math.random() * (arena.clientWidth - 60);
  const y = 90 + Math.random() * (arena.clientHeight - 150);

  heart.style.left = x + "px";
  heart.style.top = y + "px";
  arena.appendChild(heart);

  setTimeout(()=> heart.remove(), 2000);

  const check = setInterval(()=>{
    if(!heart.isConnected){ clearInterval(check); return; }

    const p = player.getBoundingClientRect();
    const h = heart.getBoundingClientRect();

    if(Math.abs(p.left - h.left) < 40 && Math.abs(p.top - h.top) < 40){
      score++;
      scoreEl.innerText = score;
      heart.remove();
      clearInterval(check);

      if(score >= TARGET){
        unlocked = true;
        yesBtn.classList.add("unlocked");
      }
    }
  }, 50);
}

/* ===== Timer ===== */
function startTimer(){
  timerInterval = setInterval(()=>{
    if(!gameStarted) return;
    time--;
    timeEl.innerText = time;

    if(time <= 0){
      onTimeUp();
    }
  }, 1000);
}

/* ===== When time is up ===== */
function onTimeUp(){
  // stop game completely
  gameStarted = false;
  clearInterval(spawnInterval);
  clearInterval(timerInterval);

  // freeze NO button
  noDodgeEnabled = false;

  // if score not enough: show message and transparent bg
  if(score < TARGET){
    document.body.classList.add("transparent-bg");
    modal.classList.add("show");
  }

  // show restart overlay (no auto reload)
  timeoutOverlay.classList.add("show");
}

/* ===== NO Button Dodge ===== */
function dodgeNo(){
  if(!gameStarted) return;
  if(!noDodgeEnabled) return;

  noBtn.style.left = (Math.random() * (arena.clientWidth - 120)) + "px";
  noBtn.style.bottom = (Math.random() * 220) + "px";
}
noBtn.addEventListener("mouseover", dodgeNo);
noBtn.addEventListener("click", dodgeNo);

/* ===== YES Button ===== */
yesBtn.addEventListener("click", ()=>{
  if(!unlocked) return;

  // stop game completely so there's NO time limit while reading
  gameStarted = false;
  clearInterval(spawnInterval);
  clearInterval(timerInterval);
  noDodgeEnabled = false;

  modal.classList.add("show");

  // Fireworks with hearts + sparkles
  for(let i=0;i<6;i++){
    setTimeout(()=> fireworksBurst(), i*220);
  }
});

/* Fireworks burst function */
function fireworksBurst(){
  const centerX = Math.random() * (window.innerWidth * 0.6) + (window.innerWidth * 0.2);
  const centerY = Math.random() * (window.innerHeight * 0.35) + (window.innerHeight * 0.18);

  const particles = 46;
  for(let i=0; i<particles; i++){
    const p = document.createElement("div");
    p.className = "particle";
    p.innerText = Math.random() < 0.7 ? "üíñ" : "‚ú®";

    const angle = (Math.PI * 2) * (i / particles);
    const power = 90 + Math.random() * 170;
    const x1 = centerX + Math.cos(angle) * power;
    const y1 = centerY + Math.sin(angle) * power;

    p.style.setProperty("--x0", centerX + "px");
    p.style.setProperty("--y0", centerY + "px");
    p.style.setProperty("--x1", x1 + "px");
    p.style.setProperty("--y1", y1 + "px");
    p.style.setProperty("--dur", (900 + Math.random()*700) + "ms");

    p.style.fontSize = (16 + Math.random()*18) + "px";
    document.body.appendChild(p);
    setTimeout(()=> p.remove(), 1700);
  }
}

/* Close modal when clicking outside */
modal.addEventListener("click", (e)=>{
  if(e.target === modal) modal.classList.remove("show");
});

/* ===== Start / Restart ===== */
function resetGame(){
  // restore background + overlays
  document.body.classList.remove("transparent-bg");
  modal.classList.remove("show");
  timeoutOverlay.classList.remove("show");

  // remove leftover hearts in arena
  arena.querySelectorAll(".heart").forEach(h => h.remove());

  // reset state
  score = 0;
  time = START_TIME;
  unlocked = false;
  noDodgeEnabled = true;

  scoreEl.innerText = "0";
  timeEl.innerText = String(START_TIME);
  yesBtn.classList.remove("unlocked");

  // place player
  const rect = arena.getBoundingClientRect();
  movePlayer(rect.left + rect.width/2, rect.top + rect.height*0.7);

  // start loops
  gameStarted = true;
  spawnInterval = setInterval(spawnHeart, 700);
  startTimer();
}

startBtn.addEventListener("click", ()=>{
  startOverlay.style.display = "none";
  resetGame();
});

restartBtn.addEventListener("click", ()=>{
  resetGame();
});

/* ===== Background Floating Hearts (BIGGER) ===== */
function createFloatingHeart(){
  // don't spawn if transparent background is active
  if(document.body.classList.contains("transparent-bg")) return;

  const heart = document.createElement("div");
  heart.classList.add("floating-heart");
  heart.innerText = Math.random() < 0.5 ? "üíñ" : "üíó";

  const size = Math.random() * 26 + 34;
  const left = Math.random() * 100;
  const duration = Math.random() * 4 + 7;

  heart.style.fontSize = size + "px";
  heart.style.left = left + "vw";
  heart.style.animationDuration = duration + "s";

  heartBg.appendChild(heart);
  setTimeout(()=> heart.remove(), duration * 1000);
}
setInterval(createFloatingHeart, 320);
</script>

</body>
</html>
